(self.webpackChunkvue3_music=self.webpackChunkvue3_music||[]).push([[202],{2177:(t,e,a)=>{"use strict";a.r(e),a.d(e,{default:()=>M});var n=a(6252),i=a(3577),l=(0,n.HX)("data-v-bfa60630");(0,n.dD)("data-v-bfa60630");var s={class:"musicHeader"},r=(0,n.Wm)("span",{class:"iconfont"}," ",-1),c={alt:""},u={class:"btm"},o={class:"name"},m={key:0,class:"playCount"},p=(0,n.Wm)("span",{class:"iconfont"}," ",-1),d={key:0,class:"content"},g={class:"contentTop"},f={class:"length"};(0,n.Cn)();e=l((function(t,e,a,l,v,y){var b=(0,n.up)("MusicList"),w=(0,n.Q2)("lazy");return(0,n.wg)(),(0,n.j4)(n.HY,null,[(0,n.Wm)("div",s,[(0,n.Wm)("div",{class:{top:!0,fixed:t.topFixedFlag},onClick:e[1]||(e[1]=function(e){return t.$router.back()}),ref:"topEl"},[r,(0,n.Uk)(" "+(0,i.zw)(t.musicListData.title),1)],2),(0,n.wy)((0,n.Wm)("img",c,null,512),[[w,t.musicListData.bg]]),(0,n.Wm)("div",u,[(0,n.Wm)("p",o,(0,i.zw)(t.musicListData.tip),1),t.isSinger||t.isRecommend||t.isAlbum?(0,n.ry)("v-if",!0):((0,n.wg)(),(0,n.j4)("p",m,[p,(0,n.Uk)(" "+(0,i.zw)(t.filterCount(t.playlist.playCount)),1)]))])]),t.musicListData.list&&t.musicListData.list.length?((0,n.wg)(),(0,n.j4)("div",d,[(0,n.Wm)("div",g,[(0,n.Wm)("span",{class:"iconfont",onClick:e[2]||(e[2]=function(){return t.playAll&&t.playAll.apply(t,arguments)})},""),(0,n.Wm)("span",null,(0,i.zw)(t.isSinger?"热门歌曲":"播放全部"),1),(0,n.Wm)("span",f,"（共"+(0,i.zw)(t.musicListData.list.length)+"首）",1),(0,n.Wm)("span",{class:"addAll",onClick:e[3]||(e[3]=function(){return t.addAll&&t.addAll.apply(t,arguments)})},"全部添加到播放列表")]),(0,n.Wm)(b,{musicList:t.musicListData.list,showPlay:!0},null,8,["musicList"])])):(0,n.ry)("v-if",!0)],64)}));var v=a(6156),y=(a(8983),a(6123)),b=a(2137),w=(l=a(7757),a.n(l)),h=a(2262),k=a(2119),D=a(894),L=a(6138),P=a(6444),j=a(8771),O=a(2775),S=a(2730);function W(t,e){var a,n=Object.keys(t);return Object.getOwnPropertySymbols&&(a=Object.getOwnPropertySymbols(t),e&&(a=a.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,a)),n}function C(t){for(var e=1;e<arguments.length;e++){var a=null!=arguments[e]?arguments[e]:{};e%2?W(Object(a),!0).forEach((function(e){(0,v.Z)(t,e,a[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(a)):W(Object(a)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(a,e))}))}return t}const A=(0,n.aZ)({name:"MusicDetail",setup:function(){var t=(0,k.yj)(),e=(0,D.oR)(),a=(0,h.iH)(null),i=(0,h.iH)(!1),l=(0,n.Fl)((function(){return t.query.type})),s=(0,h.qj)({playlist:{},songs:[],recommend:[],album:{}}),r=(0,n.Fl)((function(){return e.state.Home.currentSinger})),c=(0,n.Fl)((function(){return"singer"===l.value})),u=(0,n.Fl)((function(){return"recommend"===l.value})),o=(0,n.Fl)((function(){return"album"===l.value}));(0,n.bv)((0,b.Z)(w().mark((function t(){return w().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,m();case 2:window.addEventListener("scroll",p);case 3:case"end":return t.stop()}}),t)}))));var m=function(){var e=(0,b.Z)(w().mark((function e(){var a,n,i,l;return w().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.query.id,i=c.value?L.SN.getSingerPlayListDetail:u.value?L.e4.getRecommendMusic:o.value?L.e4.getSingerAlbumContent:L.SN.getPlayListDetail,e.next=4,i({id:n});case 4:i=e.sent,c.value?s.songs=(0,j.i)(i.data.songs):u.value?s.recommend=(0,j.i)(i.data.data.dailySongs):o.value?(l=(0,j.i)(i.data.songs),s.album.album=i.data.album,s.album.songs=l):(a=i.data.playlist,n=a.tracks,a.tracks=(0,j.i)(n,i.data.privileges),l=a.trackIds,n=a.tracks.length,i=l.length,n<i&&(l=l.map((function(t){return t.id})).join(","),L.SN.getMusicDetail({ids:l}).then((function(t){a.tracks=(0,j.i)(t.data.songs,t.data.privileges),g.value=f()}))),s.playlist=a),g.value=f();case 7:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();function p(){var t=a.value.offsetHeight;i.value=window.scrollY>t}function d(){var t=g.value.list;e.commit("PlayMusic/setPlayListIndex",0),e.dispatch("PlayMusic/setPlayLists",{type:"all",params:t}),O.Z.$emit("playListChange"),e.commit("PlayMusic/setPlayShow",!0)}(0,n.Ah)((function(){window.removeEventListener("scroll",p)}));var g=(0,h.iH)({}),f=function(){var t,e={title:"",tip:"",bg:"",list:[]};return c.value?(e.title="歌手",e.tip=r.value.name,e.bg="".concat(r.value.img1v1Url,"?param=375y300"),e.list=s.songs):u.value?(t=new Date,e.title="每日歌单",e.tip="".concat(t.getMonth()+1,"/").concat(t.getDate()),s.recommend.length&&s.recommend[0].al&&(e.bg="".concat(s.recommend[0].al.picUrl,"?param=375y300")),e.list=s.recommend):o.value?(e.title="专辑",e.tip=s.album.album.name,e.bg="".concat(s.album.album.picUrl,"?param=375y300"),e.list=s.album.songs):(e.title="歌单",e.tip=s.playlist.name,e.bg="".concat(s.playlist.coverImgUrl,"?param=375y300"),e.list=s.playlist.tracks),e};return C(C({},(0,h.BK)(s)),{},{filterCount:P.n,singerDetail:r,isSinger:c,isRecommend:u,isAlbum:o,musicListData:g,playAll:d,addAll:function(){var t=(0,S.I8)(e.state.PlayMusic.playList);if(t.length){var a=g.value.list.filter((function(e){return!t.map((function(t){return t.id})).includes(e.id)}));if(!a.length)return(0,y.Z)({type:"danger",message:"播放列表已经有这些歌了~"});t=t.concat(a),e.dispatch("PlayMusic/setPlayLists",{type:"all",params:t}).then((function(){return(0,y.Z)({type:"success",message:"添加成功~"})}))}else d()},topEl:a,topFixedFlag:i})}});A.render=e,A.__scopeId="data-v-bfa60630";const M=A}}]);
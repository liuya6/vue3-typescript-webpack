(self.webpackChunkvue3_music=self.webpackChunkvue3_music||[]).push([[501],{3501:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>S});var n=r(6252),a=r(3577),u=(0,n.HX)("data-v-27d6c6e5");(0,n.dD)("data-v-27d6c6e5");var o={class:"telLogin"},s={style:{margin:"16px"}},c=(0,n.Uk)(" 提交 "),i=(0,n.Wm)("p",{class:"qrText"},"使用网易云账号登录",-1),l={key:0,class:"qr"},p={class:"qrText"},d=(0,n.Wm)("p",{class:"qrText"},"长按保存图片到相册，使用网易云音乐扫码登录",-1);(0,n.Cn)();var f=u((function(e,t,r,f,m,v){var b=(0,n.up)("Header"),h=(0,n.up)("van-field"),y=(0,n.up)("van-button"),k=(0,n.up)("van-form"),w=(0,n.up)("van-tab"),g=(0,n.up)("Qrcode"),x=(0,n.up)("van-tabs");return(0,n.wg)(),(0,n.j4)(n.HY,null,[(0,n.Wm)(b,{title:"登录"}),(0,n.Wm)(x,{active:e.active,"onUpdate:active":t[3]||(t[3]=function(t){return e.active=t})},{default:u((function(){return[(0,n.Wm)(w,{title:"手机号登录"},{default:u((function(){return[(0,n.Wm)("div",o,[(0,n.Wm)(k,{onSubmit:e.onSubmit},{default:u((function(){return[(0,n.Wm)(h,{modelValue:e.tel,"onUpdate:modelValue":t[1]||(t[1]=function(t){return e.tel=t}),type:"tel",name:"phone",label:"手机号",placeholder:"请输入手机号",rules:[{pattern:e.phonePattern,message:"请填写手机号"}]},null,8,["modelValue","rules"]),(0,n.Wm)(h,{modelValue:e.password,"onUpdate:modelValue":t[2]||(t[2]=function(t){return e.password=t}),type:"password",name:"password",label:"密码",placeholder:"密码",rules:[{pattern:e.passwordPattern,message:"请填写密码"}]},null,8,["modelValue","rules"]),(0,n.Wm)("div",s,[(0,n.Wm)(y,{round:"",block:"",type:"primary","native-type":"submit"},{default:u((function(){return[c]})),_:1})])]})),_:1},8,["onSubmit"]),i])]})),_:1}),(0,n.Wm)(w,{title:"二维码登录"},{default:u((function(){return[e.qrUrl?((0,n.wg)(),(0,n.j4)("div",l,[(0,n.Wm)(g,{text:e.qrUrl,width:"150",height:"150"},null,8,["text"])])):(0,n.ry)("v-if",!0),(0,n.Wm)("p",p,(0,a.zw)(e.qrStatusText),1),d]})),_:1})]})),_:1},8,["active"])],64)})),m=r(6156),v=(r(2148),r(1751)),b=r(2137),h=(t=r(7757),r.n(t)),y=r(2262),k=r(894),w=r(2119),g=(t=r(8495),r.n(t)),x=r(6138);function O(e,t){var r,n=Object.keys(e);return Object.getOwnPropertySymbols&&(r=Object.getOwnPropertySymbols(e),t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)),n}function q(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?O(Object(r),!0).forEach((function(t){(0,m.Z)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):O(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}const j=(0,n.aZ)({name:"Login",setup:function(){var e=(0,y.iH)(0),t=(0,k.oR)(),r=(0,w.tv)(),a=(0,y.qj)({unikey:"",qrUrl:"",qrStatus:0}),u=(0,y.qj)({tel:"",password:""}),o=function(){var e=(0,b.Z)(h().mark((function e(n){var a,u;return h().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=g()(n.password).toString(),a={phone:n.phone,md5_password:a},e.next=4,x.e4.telLogin(a);case 4:if(200!==(u=e.sent).data.code)return e.abrupt("return",v.Z.fail(u.data.message));e.next=7;break;case 7:return t.commit("User/setCookie",u.data.cookie),t.commit("User/setUserInfo",u.data.profile),t.commit("User/setToken",u.data.token),e.next=12,r.push("/");case 12:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),s=null;!function(){var e=(0,b.Z)(h().mark((function e(){var t;return h().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,x.e4.getQrKey();case 2:return t=e.sent,a.unikey=t.data.data.unikey,e.next=6,x.e4.getQrUrl({key:a.unikey});case 6:t=e.sent,a.qrUrl=t.data.data.qrurl,s=s||setInterval((function(){c()}),3e3);case 9:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()();var c=function(){var r=(0,b.Z)(h().mark((function r(){var n;return h().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:if(0===e.value)return r.abrupt("return");r.next=2;break;case 2:return r.next=4,x.e4.checkQrStatus({key:a.unikey});case 4:(n=r.sent).data.cookie&&t.commit("User/setCookie",n.data.cookie),a.qrStatus=n.data.code;case 7:case"end":return r.stop()}}),r)})));return function(){return r.apply(this,arguments)}}(),i=(0,n.Fl)((function(){switch(a.qrStatus){case 0:return"";case 800:return"二维码已失效";case 801:return"等待扫码中";case 802:return"等待授权中";case 803:return l(),t.dispatch("User/checkLoginStatus").then((function(){r.push("/")})),"授权成功"}}));(0,n.Ah)((function(){l()}));var l=function(){clearInterval(s),s=null};return q(q(q({active:e},(0,y.BK)(u)),(0,y.BK)(a)),{},{onSubmit:o,phonePattern:/1\d{10}/,passwordPattern:/\S\d{6,}$/,qrStatusText:i})}});j.render=f,j.__scopeId="data-v-27d6c6e5";const S=j}}]);